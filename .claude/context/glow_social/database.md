# Glow Social Database Schema

| admin_audit_log          | - id (uuid)
- admin_id (text)
- admin_email (text)
- action (text)
- target_user_id (text)
- target_email (text)
- metadata (jsonb)
- created_at (timestamp with time zone)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| affiliate_referrals      | - id (uuid)
- affiliate_id (uuid)
- customer_email (text)
- customer_name (text)
- signup_date (timestamp with time zone)
- status (text)
- subscription_tier (text)
- monthly_value (numeric)
- commission_earned (numeric)
- pending_commission (numeric)
- last_commission_date (timestamp with time zone)
- created_at (timestamp with time zone)
- updated_at (timestamp with time zone)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| affiliates               | - id (uuid)
- email (text)
- name (text)
- referral_code (text)
- commission_rate (numeric)
- payment_method (text)
- payment_details (jsonb)
- is_active (boolean)
- last_payment_date (timestamp with time zone)
- created_at (timestamp with time zone)
- updated_at (timestamp with time zone)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| ai_usage_alerts          | - id (uuid)
- user_id (uuid)
- alert_type (text)
- message (text)
- threshold_value (numeric)
- actual_value (numeric)
- created_at (timestamp with time zone)
- acknowledged (boolean)
- acknowledged_at (timestamp with time zone)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| ai_usage_analytics       | - date (date)
- provider (text)
- model (text)
- request_count (bigint)
- total_tokens (bigint)
- total_cost (numeric)
- avg_tokens_per_request (numeric)
- avg_cost_per_request (numeric)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| ai_usage_logs            | - id (uuid)
- user_id (uuid)
- provider (text)
- model (text)
- input_tokens (integer)
- output_tokens (integer)
- total_tokens (integer)
- input_cost_usd (numeric)
- output_cost_usd (numeric)
- total_cost_usd (numeric)
- purpose (text)
- metadata (jsonb)
- created_at (timestamp with time zone)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| audit_critical_events    | - id (uuid)
- operation_type (character varying)
- user_id (uuid)
- description (text)
- metadata (jsonb)
- error_details (jsonb)
- ip_address (inet)
- correlation_id (character varying)
- created_at (timestamp with time zone)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| audit_trail              | - id (uuid)
- operation_type (character varying)
- user_id (uuid)
- severity (character varying)
- description (text)
- metadata (jsonb)
- before_state (jsonb)
- after_state (jsonb)
- error_details (jsonb)
- ip_address (inet)
- user_agent (text)
- session_id (character varying)
- correlation_id (character varying)
- environment (character varying)
- created_at (timestamp with time zone)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| audit_trail_backup       | - id (uuid)
- operation_type (character varying)
- user_id (uuid)
- severity (character varying)
- description (text)
- metadata (jsonb)
- before_state (jsonb)
- after_state (jsonb)
- error_details (jsonb)
- ip_address (inet)
- user_agent (text)
- session_id (character varying)
- correlation_id (character varying)
- environment (character varying)
- created_at (timestamp with time zone)
- original_error (text)
- fallback_logged_at (timestamp with time zone)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| cancellation_logs        | - id (uuid)
- user_id (uuid)
- email (text)
- reason (text)
- feedback (text)
- cleanup_results (jsonb)
- created_at (timestamp with time zone)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| content_generation_jobs  | - id (uuid)
- job_id (text)
- user_id (uuid)
- type (text)
- status (text)
- total_posts (integer)
- completed_posts (integer)
- errors (jsonb)
- created_at (timestamp with time zone)
- updated_at (timestamp with time zone)
- completed_at (timestamp with time zone)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| content_generation_queue | - id (uuid)
- user_id (uuid)
- month (character varying)
- total_posts (integer)
- post_index (integer)
- status (character varying)
- priority (integer)
- error_message (text)
- error_count (integer)
- created_at (timestamp with time zone)
- updated_at (timestamp with time zone)
- completed_at (timestamp with time zone)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| content_pillars          | - id (uuid)
- user_id (uuid)
- pillar_number (integer)
- pillar_name (text)
- pillar_description (text)
- why_important (text)
- example_subtopics (text)
- created_at (timestamp with time zone)
- updated_at (timestamp with time zone)
- pillar_order (integer)
- description (text)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| content_posts            | - id (uuid)
- record_id (text)
- user_id (uuid)
- month_of (date)
- long_caption (text)
- short_caption (text)
- pillar (text)
- topic_angle (text)
- visual_suggestion (text)
- image_url (text)
- status (text)
- hashtags (text)
- scheduled_for (timestamp with time zone)
- ayrshare_post_id (text)
- platforms (ARRAY)
- created_at (timestamp with time zone)
- updated_at (timestamp with time zone)
- platform_content (jsonb)
- visible_after (date)
- release_month (integer)
- content_pillar (text)
- post_type (text)
- urgency (text)
- retry_count (integer)
- error_message (text)
- inngest_job_id (text)
- published_at (timestamp with time zone)
- version (integer)
- deleted_at (timestamp with time zone)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| custom_hooks             | - id (uuid)
- user_id (uuid)
- business_profile_id (uuid)
- hook_text (text)
- hook_type (text)
- category (text)
- is_seasonal (boolean)
- season (text)
- is_location_specific (boolean)
- urgency_level (text)
- usage_count (integer)
- last_used_at (timestamp with time zone)
- performance_score (numeric)
- generated_at (timestamp with time zone)
- generation_prompt (text)
- ai_model_used (text)
- created_at (timestamp with time zone)
- updated_at (timestamp with time zone)
- month_number (integer)
- sequence_in_month (integer)
- deleted_at (timestamp with time zone)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| error_logs               | - id (uuid)
- message (text)
- severity (text)
- category (text)
- code (text)
- details (jsonb)
- user_id (uuid)
- context (jsonb)
- timestamp (timestamp with time zone)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| inngest_scheduled_jobs   | - id (uuid)
- post_id (uuid)
- user_id (uuid)
- inngest_event_id (text)
- scheduled_for (timestamp with time zone)
- status (text)
- created_at (timestamp with time zone)
- updated_at (timestamp with time zone)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| migration_status         | - id (integer)
- migration_name (text)
- applied_at (timestamp with time zone)
- version (text)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| offer_analyses           | - id (uuid)
- user_id (uuid)
- offer_description (text)
- key_benefits (ARRAY)
- key_features (ARRAY)
- target_audience (text)
- value_proposition (text)
- created_at (timestamp with time zone)
- updated_at (timestamp with time zone)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| onboarding_status        | - user_id (uuid)
- needs_onboarding (boolean)
- current_step (text)
- completed_at (timestamp with time zone)
- created_at (timestamp with time zone)
- updated_at (timestamp with time zone)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| oto_customer_details     | - id (uuid)
- user_id (uuid)
- stripe_session_id (text)
- customer_name (text)
- customer_email (text)
- customer_phone (text)
- customer_location (text)
- customer_address (jsonb)
- created_at (timestamp with time zone)
- updated_at (timestamp with time zone)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| payment_audit_log        | - id (uuid)
- event_id (text)
- event_type (text)
- user_id (uuid)
- metadata (jsonb)
- ip_address (text)
- timestamp (timestamp with time zone)
- created_at (timestamp with time zone)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| platform_connections     | - id (uuid)
- user_id (uuid)
- platform (text)
- connected (boolean)
- platform_id (text)
- created_at (timestamp with time zone)
- updated_at (timestamp with time zone)
- version (integer)
- encryption_version (integer)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| posting_schedules        | - id (uuid)
- user_id (uuid)
- timezone (text)
- posting_days (ARRAY)
- time (time without time zone)
- created_at (timestamp with time zone)
- updated_at (timestamp with time zone)
- deleted_at (timestamp with time zone)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| profiles                 | - id (uuid)
- username (text)
- display_name (text)
- avatar_url (text)
- created_at (timestamp with time zone)
- updated_at (timestamp with time zone)
- email (text)
- role (text)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| rate_limit_tracking      | - identifier (text)
- bucket (text)
- count (integer)
- window_start (timestamp with time zone)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| request_signatures       | - signature (text)
- timestamp (timestamp with time zone)
- user_id (uuid)
- endpoint (text)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| security_audit_log       | - id (uuid)
- request_id (uuid)
- user_id (uuid)
- ip (text)
- user_agent (text)
- events (jsonb)
- timestamp (timestamp with time zone)
- created_at (timestamp with time zone)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| smart_feeds              | - id (uuid)
- user_id (uuid)
- topic_1 (text)
- topic_2 (text)
- topic_3 (text)
- description_1 (text)
- description_2 (text)
- description_3 (text)
- keywords (text)
- query (text)
- created_at (timestamp with time zone)
- updated_at (timestamp with time zone)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| subscription_credits     | - id (uuid)
- user_id (uuid)
- credits_remaining (integer)
- credits_used (integer)
- period_start (timestamp with time zone)
- period_end (timestamp with time zone)
- created_at (timestamp with time zone)
- updated_at (timestamp with time zone)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| subscription_plans       | - id (uuid)
- user_id (uuid)
- plan (text)
- posts_per_week (integer)
- billing_cycle (text)
- price_id (text)
- monthly_price (numeric)
- yearly_price (numeric)
- features (text)
- stripe_customer_id (text)
- created_at (timestamp with time zone)
- updated_at (timestamp with time zone)
- plan_type (text)
- status (text)
- is_active (boolean)
- amount (numeric)
- stripe_subscription_id (text)
- posts_per_month (integer)
- videos_per_month (integer)
- carousels_per_month (integer)
- is_free_trial (boolean)
- current_period_start (timestamp with time zone)
- current_period_end (timestamp with time zone)
- version (integer)
- encryption_version (integer)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| subscriptions            | - id (uuid)
- user_id (uuid)
- stripe_customer_id (text)
- stripe_subscription_id (text)
- status (text)
- price_id (text)
- quantity (integer)
- cancel_at_period_end (boolean)
- current_period_start (timestamp with time zone)
- current_period_end (timestamp with time zone)
- created_at (timestamp with time zone)
- updated_at (timestamp with time zone)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| user_activity_summary    | - user_id (uuid)
- operation_type (character varying)
- operation_count (bigint)
- last_operation (timestamp with time zone)
- first_operation (timestamp with time zone)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| user_ai_usage_summary    | - user_id (uuid)
- email (text)
- ai_usage_tier (text)
- ai_tokens_used_today (integer)
- ai_tokens_used_this_month (integer)
- ai_cost_today_usd (numeric)
- ai_cost_this_month_usd (numeric)
- total_requests (bigint)
- active_days (bigint)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| user_posts               | - id (uuid)
- user_id (uuid)
- long_caption (text)
- short_caption (text)
- platforms (ARRAY)
- scheduled_for (timestamp with time zone)
- status (text)
- image_url (text)
- created_at (timestamp with time zone)
- updated_at (timestamp with time zone)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| user_preferences         | - id (uuid)
- user_id (uuid)
- email_notifications (boolean)
- post_reminders (boolean)
- weekly_reports (boolean)
- created_at (timestamp with time zone)
- updated_at (timestamp with time zone)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| user_profiles            | - id (uuid)
- email (text)
- name (text)
- company_name (text)
- business_type (text)
- timezone (text)
- status (text)
- created_at (timestamp with time zone)
- updated_at (timestamp with time zone)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| users                    | - id (uuid)
- email (text)
- name (text)
- first_name (text)
- status (text)
- created_at (timestamp with time zone)
- last_seen_at (timestamp with time zone)
- updated_at (timestamp with time zone)
- avatar_url (text)
- magic_link (text)
- ayrshare_profile_key (text)
- query_index (integer)
- role (text)
- is_admin (boolean)
- company_name (text)
- business_type (text)
- location (text)
- phone (text)
- display_name (text)
- timezone (text)
- website (text)
- validated_url (text)
- business_one_liner (text)
- geographic_focus (text)
- target_audience (text)
- key_topics (text)
- competitors_or_industry_leaders (text)
- glow_goal (text)
- hashtags_enabled (boolean)
- homepage_content (text)
- custom_differentiators (ARRAY)
- custom_pain_points (ARRAY)
- custom_opportunities (ARRAY)
- phone_number (text)
- typical_price (text)
- universal_data (jsonb)
- cancellation_reason (text)
- cancellation_feedback (text)
- cancelled_at (timestamp with time zone)
- ayrshare_profile_created_at (timestamp with time zone)
- content_generated_at (timestamp with time zone)
- content_generation_scheduled_for (timestamp with time zone)
- encryption_version (integer)
- posts_generated_this_month (integer)
- monthly_post_limit (integer)
- last_generation_reset (timestamp with time zone)
- ai_tokens_used_today (integer)
- ai_tokens_used_this_month (integer)
- ai_cost_today_usd (numeric)
- ai_cost_this_month_usd (numeric)
- last_ai_usage_reset (timestamp with time zone)
- ai_usage_tier (text) |

## Key Relationships
- user_id connects everything
- All timestamps must be UTC
- subscription status determines access

Watch Out For

Timezone mismatches cause duplicates
Missing user_id breaks everything
RLS policies can block queries silently

